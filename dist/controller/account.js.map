{"version":3,"sources":["../../src/controller/account.js"],"names":["config","db","api","post","req","res","register","username","body","email","password","err","account","status","send","authenticate","session","scope"],"mappings":";;;;;;AAAA;;;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AAEA;;;;kBAEe,gBAAmB;AAAA,MAAhBA,MAAgB,QAAhBA,MAAgB;AAAA,MAARC,EAAQ,QAARA,EAAQ;;AAChC,MAAIC,MAAM,sBAAV;;AAEA;AACAA,MAAIC,IAAJ,CAAS,WAAT,EAAsB,UAACC,GAAD,EAAMC,GAAN,EAAc;AAClC,sBAAQC,QAAR,CAAiB,sBAAa,EAAEC,UAAUH,IAAII,IAAJ,CAASC,KAArB,EAAb,CAAjB,EAA4DL,IAAII,IAAJ,CAASE,QAArE,EAA+E,UAACC,GAAD,EAAMC,OAAN,EAAiB;AAC9F,UAAID,GAAJ,EAAS;AACP,eAAON,IAAIQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,uBAAuBH,GAA5C,CAAP;AACD;AACD,yBAASI,YAAT,CACE,OADF,EACW;AACPC,iBAAS;AADF,OADX,EAIGZ,GAJH,EAIQC,GAJR,EAIa,YAAM;AACfA,YAAIQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,kCAArB;AACD,OANH;AAOD,KAXD;AAYD,GAbD;;AAeA;AACAZ,MAAIC,IAAJ,CAAS,QAAT,EAAmB,mBAASY,YAAT,CACjB,OADiB,EACR;AACPC,aAAS,KADF;AAEPC,WAAO;AAFA,GADQ,CAAnB;AAQD,C","file":"account.js","sourcesContent":["import mongoose from \"mongoose\";\nimport { Router } from \"express\";\nimport Account from \"../model/account\";\nimport bodyParser from \"body-parser\";\nimport passport from 'passport';\nimport config from '../config';\n\nimport {generateAccessToken, respond, authenticate} from '../middleware/authMiddleware';\n\nexport default ({ config, db}) => {\n  let api = Router();\n\n  // route pour crÃ©er un compte\n  api.post('/register', (req, res) => {\n    Account.register(new Account( { username: req.body.email}), req.body.password, (err, account) =>{\n      if (err) {\n        return res.status(500).send('An error occured: ' + err);\n      }\n      passport.authenticate(\n        'local', {\n          session: false\n        })\n        (req, res, () => {\n          res.status(200).send('Successfully created new account');\n        });\n    });\n  });\n\n  // '/account/login'\n  api.post('/login', passport.authenticate(\n    'local', {\n      session: false,\n      scope: []\n    }), generateAccessToken, respond);\n\n\n\n}\n"]}